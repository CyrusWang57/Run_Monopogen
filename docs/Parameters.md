# Adjustable parameters

The following is a summary of the parameters that can be adjusted.  

## External parameter

### Counts of mismatches in preprocess

Monopogen filtered reads which have **3** mismatches comapared to reference genome by default.  
`parser_preProcess.add_argument('-m', '--max-mismatch', required=False, type=int, default=3, help="The maximal alignment mismatch allowed in one reads for variant calling")`

### reads count of each cell

Monopogen has a parameter for filtering the number of reads per cell, which by default extracts cells that are in the top **80%** in terms of read count. When you use cell barcodes that have already been filtered by software like Cell Ranger, you can set this value to 1.  
`parser_somatic.add_argument('-k', '--keep', required= False, default=0.8, help="The proportion of reads kept for somatic calling. The cell will be sorted based on reads detected and cells with fewer reads will be removed.")`  
However, in practice, I found that setting this value to 1 still results in filtering. The reason for this is not clear, but you can directly comment out the code segment that filters cells based on read count.

Line `182-186` in Monopogen.py 
```
args.keep = float(args.keep)
if args.keep < 1:
    dis = np.cumsum(df['id'])/np.sum(df['id'])
    N = sum(dis>(1-args.keep))
    df = df.iloc[-(N):]
```

## Hardcoded parameters

In addition to above external parameters, there are several parameters which may affect the result hardcoded in scripts.  

### q and Q in samtools mpileup

In samtools mpileup, q and Q represent mapping quality and base quality separatly. In Monopogen, they are set to **20** by default.
Line `77` in `monopogen.py` and Line `213` in `somatic.py`
```python
cmd1 = samtools + " mpileup -b " + bam_filter + " -f "  + reference + " -r " +  jobid + " -q 20 -Q 20 -t DP4 -d 10000 -v "
```

### ref and alt dp of de novo SNV

By default, Monopogen filters de novo SNVs based on their read depths for both reference and alternative alleles, with a threshold of **4** set separately for each.

Line `123` in `somatic.py`
```python
if (info_I16[0] + info_I16[1]>=4 and info_I16[2] + info_I16[3]>=4 or (id in info_GT)):
    ...
```
??? question "What is info_I16?"
    info_I16 is a fileld in vcf file generated by bcftools, which contains 16 fileds.  
    // The fields are:  
    //      depth fwd   .. ref (0) and non-ref (2)  
    //      depth rev   .. ref (1) and non-ref (3)  
    //      baseQ       .. ref (4) and non-ref (6)  
    //      baseQ^2     .. ref (5) and non-ref (7)  
    //      mapQ        .. ref (8) and non-ref (10)  
    //      mapQ^2      .. ref (9) and non-ref (11)  
    //      minDist     .. ref (12) and non-ref (14)  
    //      minDist^2   .. ref (13) and non-ref (15)  

### counts of SNV pairs

When calculating the germline LD-refinement score, Monopogen applies a threshold to limit the number of SNV pairs in each physical distance bin. By default, only bins containing over 100 SNV pairs are considered for generating an LD-refinement score.  
This parameter needs to be adjusted based on the characteristics of the data. When I ran it with scATACseq data, setting this parameter to 100 seemed too strict. Most SNV pairs are concentrated at larger physical distances, and smaller bins may contain only about a dozen SNV pairs, making it impossible to calculate an LD-refinement score. In my experience, adjusting this value to 10 was more appropriate.  

Line `225 and 234` in `LDrefinement.R`
```R
pos <-which(twoloci$germline_dis<binsize[i] & twoloci$germline_dis>=binsize[i-1])
if(length(pos)>100){...}

pos <-which(trioloci$germline_dis<binsize[i] & trioloci$germline_dis>=binsize[i-1])
if(length(pos)>100){...}
```